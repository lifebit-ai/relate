/*
 * -------------------------------------------------
 *  Nextflow config file for running tests
 * -------------------------------------------------
 * Defines bundled input files and everything required
 * to run a fast and simple test. Use as follows:
 *   nextflow run lifebit-ai/relate -profile test
 */
process {
  cpus = 2
  memory = 6.GB
  time = 48.h
  container = 'lifebitai/relate:latest'
  errorStrategy = { task.exitStatus in [143,137,104,134,139] ? 'retry' : 'ignore' }
}

docker.enabled = true

params {
  config_profile_name = 'Test profile'
  config_profile_description = 'Pipeline run with test data to check pipeline function'

  // Input data
  input = 's3://lifebit-featured-datasets/projects/gel/siteqc/input.csv'
  included_samples = 's3://lifebit-featured-datasets/projects/gel/siteqc/sampleList.txt'
  siteqc_results_dir = 's3://lifebit-featured-datasets/projects/gel/siteqc/ARtestFiles/siteqc_example_res'

  michigan_ld_file = 's3://lifebit-featured-datasets/projects/gel/siteqc/MichiganLD_liftover_exclude_regions_PARSED.txt'
  ancestry_probs = 's3://lifebit-featured-datasets/projects/gel/siteqc/aggV2_R9_M30K_1KGP3_ancestry_assignment_probs.tsv'
  pcs_ancestry = 's3://lifebit-featured-datasets/projects/gel/siteqc/aggV2_bedmerge_30KSNPs_labkeyV9_08062020_update_PCsancestryrelated.tsv'

  unrelated_1kgp3 = 's3://lifebit-featured-datasets/projects/gel/siteqc/UNRELATED_1KGP3.samples'
  samplelist_1kgp3 = 's3://lifebit-featured-datasets/projects/gel/siteqc/1KGP3.sample_table'
  example_eigenvec = 's3://lifebit-featured-datasets/projects/gel/siteqc/1KGP3_30K_unrel_autosomes.eigenvec'
  example_proj_eigenvec = 's3://lifebit-featured-datasets/projects/gel/siteqc/1KGP3_30K_unrel_autosomes.eigenvec_TMPPROJ'

  super_pop_codes = 's3://lifebit-featured-datasets/projects/gel/siteqc/super_pop_codes.tsv'

  // Parameters
  n_pca = 20

  // AWK expressions
  awk_expr_create_final_king_vcf_1 = 'NR==FNR{c[\$1\$2\$3\$4]++;next}; c[\$1\$2\$4\$5] > 0'

}
